<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>The Pool Ladder - Competitive 8-Ball Tournament</title>
    
    <!-- PWA Meta Tags -->
    <meta name="description" content="Premier competitive 8-ball pool league management system">
    <meta name="theme-color" content="#00d4ff">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="apple-mobile-web-app-title" content="Pool Ladder">
    <meta name="msapplication-TileColor" content="#00d4ff">
    <meta name="msapplication-tap-highlight" content="no">
    
    <!-- PWA Icons -->
    <link rel="icon" type="image/svg+xml" href="/icons/icon-192x192.svg">
    <link rel="apple-touch-icon" href="/icons/icon-192x192.svg">
    <link rel="mask-icon" href="/icons/icon-192x192.svg" color="#00d4ff">
    
    <!-- PWA Manifest -->
    <link rel="manifest" href="/manifest.json">
    
    <!-- DNS prefetch for external resources -->
    <link rel="dns-prefetch" href="https://cdn.jsdelivr.net">

    <!-- Self-hosted fonts for better privacy and performance -->
    <link rel="stylesheet" href="css/fonts.css">
    <link rel="stylesheet" href="css/styles.css">
</head>
<body>
    <!-- Skip to main content link for keyboard navigation -->
    <a href="#main-content" class="skip-to-content">Skip to main content</a>
    
    <!-- Header Section -->
    <header class="header" role="banner">
        <div class="container">
            <div class="logo">
                <div class="logo-icon">ðŸŽ±</div>
                <span class="logo-text">The Pool Ladder</span>
            </div>
            <nav class="nav" aria-label="Primary navigation">
                <a href="index.html" class="nav-link active" aria-current="page">Home</a>
                <a href="pages/ladder.html" class="nav-link">Ladder</a>
                <a href="pages/matches.html" class="nav-link">Matches</a>
                <a href="https://www.ultimatepoolgroup.com/rules" target="_blank" class="nav-link" rel="noopener noreferrer">Rules</a>
            </nav>
            <div class="user-actions">
                <a href="pages/login.html" class="admin-link" aria-label="Admin login">Admin</a>
                <button class="mobile-menu-btn" onclick="toggleMobileMenu()" aria-label="Toggle navigation menu" aria-expanded="false" aria-controls="mobileNav">
                    <span></span>
                    <span></span>
                    <span></span>
                </button>
            </div>
        </div>
    </header>

    <!-- Mobile Navigation Overlay -->
    <nav class="mobile-nav" id="mobileNav" role="navigation" aria-label="Mobile navigation">
        <a href="index.html" class="nav-link active" onclick="closeMobileMenu()" aria-current="page">Home</a>
        <a href="pages/ladder.html" class="nav-link" onclick="closeMobileMenu()">Ladder</a>
        <a href="pages/matches.html" class="nav-link" onclick="closeMobileMenu()">Matches</a>
        <a href="https://www.ultimatepoolgroup.com/rules" target="_blank" class="nav-link" onclick="closeMobileMenu()" rel="noopener noreferrer">Rules</a>
        <a href="pages/login.html" class="admin-link" onclick="closeMobileMenu()" aria-label="Admin login">Admin</a>
    </nav>

    <!-- Hero Section -->
    <main id="main-content" role="main">
    <section class="hero">
        <div class="hero-background"></div>
        <div class="container">
            <div class="hero-content stagger-animation">
                <div class="hero-text">
                    <h1 class="hero-title floating">THE POOL LADDER</h1>
                </div>
            </div>
        </div>
    </section>

    <!-- Quick Links Section -->
    <section class="quick-links" aria-label="Quick access links">
        <div class="container">
            <div class="links-grid stagger-animation">
                <a href="pages/ladder.html" class="link-card" aria-label="View player rankings">
                    <h3>View Rankings</h3>
                </a>
                <a href="pages/matches.html" class="link-card" aria-label="View match center">
                    <h3>Match Center</h3>
                </a>
            </div>
        </div>
    </section>

    <!-- Call to Action -->
    <section class="cta" aria-label="Join the league">
        <div class="container">
            <div class="cta-content">
                <h2>JOIN THE 2026 LEAGUE</h2>
                <div class="cta-buttons">
                    <button class="btn btn-primary btn-large" onclick="openJoinModal()" aria-label="Open application form to join the league">APPLY TO JOIN</button>
                    <a href="pages/rules.html" class="btn btn-outline btn-large" aria-label="View league rules and regulations">View Rules</a>
                </div>
            </div>
        </div>
    </section>

    </main>
    
    <!-- Footer -->
    <footer class="footer" role="contentinfo">
        <div class="container">
            <div class="footer-content">
                <div class="footer-section">
                    <h4>The Pool Ladder</h4>
                </div>
                <div class="footer-section">
                    <h4>Quick Links</h4>
                    <a href="https://www.ultimatepoolgroup.com/rules" target="_blank" rel="noopener noreferrer">Rules</a>
                    <a href="pages/ladder.html">Rankings</a>
                    <a href="pages/matches.html">Matches</a>
                </div>
                <div class="footer-section">
                    <h4>Contact</h4>
                    <p>fasteddiespoolleague@proton.me</p>
                </div>
            </div>
            <div class="footer-bottom">
                <p>&copy; 2025 The Pool Ladder. All rights reserved.</p>
            </div>
        </div>
    </footer>

    <!-- Join Competition Modal -->
    <div class="modal" id="joinModal" role="dialog" aria-modal="true" aria-labelledby="joinModalTitle">
        <div class="modal-content">
            <div class="modal-header">
                <h3 id="joinModalTitle">League Application</h3>
                <button class="modal-close" onclick="closeJoinModal()" aria-label="Close application form">&times;</button>
            </div>
            <div class="modal-body">
                <p class="join-intro">Submit your application to join our league. We'll review your information and contact you with next steps.</p>
                <form id="joinForm" class="join-form">
                    <div class="form-group">
                        <label for="joinName">Full Name *</label>
                        <input type="text" id="joinName" name="name" class="form-input" placeholder="Enter your full name" required aria-required="true">
                    </div>
                    <div class="form-group">
                        <label for="joinEmail">Email Address *</label>
                        <input type="email" id="joinEmail" name="email" class="form-input" placeholder="Enter your email address" required aria-required="true">
                    </div>
                    <div class="form-group">
                        <label for="joinExperience">Experience Level *</label>
                        <select id="joinExperience" name="experience" class="form-input" required aria-required="true">
                            <option value="">Select your experience level</option>
                            <option value="beginner">Beginner - New to competitive play</option>
                            <option value="intermediate">Intermediate - Some tournament experience</option>
                            <option value="advanced">Advanced - Experienced competitor</option>
                            <option value="professional">Professional - Tournament winner</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="joinMessage">Additional Information (Optional)</label>
                        <textarea id="joinMessage" name="message" class="form-textarea" rows="3" placeholder="Share any relevant pool experience or questions about the league..." aria-describedby="joinMessageHelp"></textarea>
                        <span id="joinMessageHelp" class="sr-only">Optional field to share additional information about your pool experience</span>
                    </div>
                    <div id="joinFormStatus" class="form-status" style="display: none;"></div>
                </form>
            </div>
            <div class="modal-footer">
                <button class="btn btn-outline" onclick="closeJoinModal()" aria-label="Cancel application">Cancel</button>
                <button type="submit" form="joinForm" class="btn btn-primary" id="joinSubmitBtn" aria-label="Submit league application">
                    <span class="submit-text">Submit Application</span>
                    <span class="submit-loading" style="display: none;">Sending...</span>
                </button>
            </div>
        </div>
    </div>

    <!-- EmailJS for automatic email sending -->
    <script type="text/javascript" src="https://cdn.jsdelivr.net/npm/@emailjs/browser@4/dist/email.min.js"></script>
    
    <script src="js/main.js"></script>
    
    <!-- PWA Service Worker Registration -->
    <script>
        // Register service worker for PWA functionality
        if ('serviceWorker' in navigator) {
            window.addEventListener('load', () => {
                navigator.serviceWorker.register('/sw.js')
                    .then(registration => {
                        console.log('ðŸŽ± PWA: Service Worker registered successfully');
                        
                        // Listen for updates
                        registration.addEventListener('updatefound', () => {
                            const newWorker = registration.installing;
                            newWorker.addEventListener('statechange', () => {
                                if (newWorker.state === 'installed' && navigator.serviceWorker.controller) {
                                    // New version available
                                    if (confirm('New version available! Reload to update?')) {
                                        window.location.reload();
                                    }
                                }
                            });
                        });
                    })
                    .catch(error => {
                        console.log('âŒ PWA: Service Worker registration failed:', error);
                    });
            });
        }
        
        // Listen for messages from service worker
        navigator.serviceWorker?.addEventListener('message', event => {
            if (event.data.type === 'SYNC_DATA') {
                console.log('ðŸ“¡ PWA: ' + event.data.message);
                // Trigger data refresh if needed
                if (window.loadAndDisplayLadder) {
                    window.loadAndDisplayLadder();
                }
            }
        });
        
        // Add to home screen prompt
        let deferredPrompt;
        window.addEventListener('beforeinstallprompt', (e) => {
            e.preventDefault();
            deferredPrompt = e;
            
            // Show install button or banner
            showInstallPrompt();
        });
        
        function showInstallPrompt() {
            // Create install banner
            const installBanner = document.createElement('div');
            installBanner.style.cssText = `
                position: fixed;
                top: 0;
                left: 0;
                right: 0;
                background: linear-gradient(135deg, #00d4ff, #0a0a0a);
                color: white;
                padding: 12px;
                text-align: center;
                z-index: 10000;
                font-family: var(--font-primary);
                transform: translateY(-100%);
                transition: transform 0.3s ease;
            `;
            installBanner.innerHTML = `
                <span>ðŸ“± Install Pool Ladder app for quick access!</span>
                <button id="installBtn" style="margin-left: 10px; background: white; color: #0a0a0a; border: none; padding: 6px 12px; border-radius: 4px; cursor: pointer;">Install</button>
                <button id="dismissBtn" style="margin-left: 10px; background: transparent; color: white; border: 1px solid white; padding: 6px 12px; border-radius: 4px; cursor: pointer;">Maybe Later</button>
            `;
            
            document.body.appendChild(installBanner);
            
            // Animate in
            setTimeout(() => {
                installBanner.style.transform = 'translateY(0)';
            }, 100);
            
            // Install button click
            installBanner.querySelector('#installBtn').addEventListener('click', async () => {
                if (deferredPrompt) {
                    deferredPrompt.prompt();
                    const { outcome } = await deferredPrompt.userChoice;
                    console.log('ðŸ“± PWA: Install prompt result:', outcome);
                    deferredPrompt = null;
                }
                installBanner.remove();
            });
            
            // Dismiss button click
            installBanner.querySelector('#dismissBtn').addEventListener('click', () => {
                installBanner.style.transform = 'translateY(-100%)';
                setTimeout(() => installBanner.remove(), 300);
            });
            
            // Auto-hide after 10 seconds
            setTimeout(() => {
                if (installBanner.parentElement) {
                    installBanner.style.transform = 'translateY(-100%)';
                    setTimeout(() => installBanner.remove(), 300);
                }
            }, 10000);
        }
    </script>
</body>
</html>